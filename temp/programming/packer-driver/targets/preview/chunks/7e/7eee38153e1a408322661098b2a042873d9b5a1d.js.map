{"version":3,"sources":["file:///E:/CocosCreator/StormSunder_Github/StormSunder/assets/module_storm_sunder/Script/Manager/GameMgr.ts"],"names":["GameMgr","tgxUIMgr","StormSunderGlobalInstance","PropMgr","TimerMgr","UI_BattleResult","PlayerMgr","gameStatus","GameStatus","None","isWin","Instance","_instance","setGameStatus","status","updateGameStatusUI","getGameStatus","homeUI","instance","battleUI","active","Playing","inst","setPlayerVisible","End","showUI","startGame","genatorProp","playerAddComponent","genareatorAIPlayer","startCountdown"],"mappings":";;;kHASaA,O;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAPJC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,yB,iBAAAA,yB;;AACAC,MAAAA,O,iBAAAA,O;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,S,iBAAAA,S;;;;;;AAPT;;;yBASaN,O,GAAN,MAAMA,OAAN,CAAc;AAAA;AASjB;AATiB,eAUVO,UAVU,GAUeC,UAAU,CAACC,IAV1B;AAYjB;AAZiB,eAaVC,KAbU,GAaO,IAbP;AAAA;;AAES,mBAARC,QAAQ,GAAY;AAClC,cAAI,KAAKC,SAAL,IAAkB,IAAtB,EAA4B;AACxB,iBAAKA,SAAL,GAAiB,IAAIZ,OAAJ,EAAjB;AACH;;AACD,iBAAO,KAAKY,SAAZ;AACH;;AAQD;AACOC,QAAAA,aAAa,CAACC,MAAD,EAAqB;AACrC,eAAKP,UAAL,GAAkBO,MAAlB;AACA,eAAKC,kBAAL;AACH,SAnBgB,CAqBjB;;;AACOC,QAAAA,aAAa,GAAe;AAC/B,iBAAO,KAAKT,UAAZ;AACH,SAxBgB,CA0BjB;;;AACaQ,QAAAA,kBAAkB,GAAG;AAAA;;AAAA;AAC9B,gBAAME,MAAM,GAAG;AAAA;AAAA,wEAA0BC,QAA1B,CAAmCD,MAAlD;AACA,gBAAME,QAAQ,GAAG;AAAA;AAAA,wEAA0BD,QAA1B,CAAmCC,QAApD;;AAEA,oBAAQ,KAAI,CAACZ,UAAb;AACI,mBAAKC,UAAU,CAACC,IAAhB;AACIQ,gBAAAA,MAAM,CAACG,MAAP,GAAgB,IAAhB;AACAD,gBAAAA,QAAQ,CAACC,MAAT,GAAkB,KAAlB;AACA;;AACJ,mBAAKZ,UAAU,CAACa,OAAhB;AACI,sBAAM;AAAA;AAAA,4CAAUC,IAAV,CAAeC,gBAAf,CAAgC,IAAhC,CAAN;AACAN,gBAAAA,MAAM,CAACG,MAAP,GAAgB,KAAhB;AACAD,gBAAAA,QAAQ,CAACC,MAAT,GAAkB,IAAlB;AACA;;AACJ,mBAAKZ,UAAU,CAACgB,GAAhB;AACI;AAAA;AAAA,0CAASF,IAAT,CAAcG,MAAd;AAAA;AAAA;AACA;AAZR;AAJ8B;AAkBjC;;AAEqB,mBAAJH,IAAI,GAAY;AAC9B,iBAAO,KAAKX,QAAZ;AACH;;AAEYe,QAAAA,SAAS,GAAG;AAAA;AACrB1B,YAAAA,OAAO,CAACsB,IAAR,CAAaT,aAAb,CAA2BL,UAAU,CAACa,OAAtC;AACA,kBAAM;AAAA;AAAA,oCAAQC,IAAR,CAAaK,WAAb,EAAN;AACA,kBAAM;AAAA;AAAA,wCAAUL,IAAV,CAAeM,kBAAf,EAAN;AACA,kBAAM;AAAA;AAAA,wCAAUN,IAAV,CAAeO,kBAAf,EAAN;AACA;AAAA;AAAA,sCAASP,IAAT,CAAcQ,cAAd;AALqB;AAMxB;;AAzDgB,O;;AAAR9B,MAAAA,O,CACMY,S;;4BA2DPJ,U,0BAAAA,U;AAAAA,QAAAA,U,CAAAA,U;AAAAA,QAAAA,U,CAAAA,U;AAAAA,QAAAA,U,CAAAA,U;eAAAA,U","sourcesContent":["/** 游戏管理器*/\r\n\r\nimport { tgxUIMgr } from \"db://assets/core_tgx/tgx\";\r\nimport { StormSunderGlobalInstance } from \"../StormSunderGlobalInstance\";\r\nimport { PropMgr } from \"./PropMgr\";\r\nimport { TimerMgr } from \"./TimerMgr\";\r\nimport { UI_BattleResult } from \"db://assets/scripts/UIDef\";\r\nimport { PlayerMgr } from \"./PlayerMgr\";\r\n\r\nexport class GameMgr {\r\n    private static _instance: GameMgr;\r\n    public static get Instance(): GameMgr {\r\n        if (this._instance == null) {\r\n            this._instance = new GameMgr();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    //游戏状态\r\n    public gameStatus: GameStatus = GameStatus.None;\r\n\r\n    //输赢状态\r\n    public isWin: boolean = true;\r\n\r\n    //设置游戏状态\r\n    public setGameStatus(status: GameStatus) {\r\n        this.gameStatus = status;\r\n        this.updateGameStatusUI();\r\n    }\r\n\r\n    //获取游戏状态\r\n    public getGameStatus(): GameStatus {\r\n        return this.gameStatus;\r\n    }\r\n\r\n    //游戏状态更新UI\r\n    public async updateGameStatusUI() {\r\n        const homeUI = StormSunderGlobalInstance.instance.homeUI;\r\n        const battleUI = StormSunderGlobalInstance.instance.battleUI;\r\n\r\n        switch (this.gameStatus) {\r\n            case GameStatus.None:\r\n                homeUI.active = true;\r\n                battleUI.active = false;\r\n                break;\r\n            case GameStatus.Playing:\r\n                await PlayerMgr.inst.setPlayerVisible(true);\r\n                homeUI.active = false;\r\n                battleUI.active = true;\r\n                break;\r\n            case GameStatus.End:\r\n                tgxUIMgr.inst.showUI(UI_BattleResult);\r\n                break;\r\n        }\r\n    }\r\n\r\n    public static get inst(): GameMgr {\r\n        return this.Instance;\r\n    }\r\n\r\n    public async startGame() {\r\n        GameMgr.inst.setGameStatus(GameStatus.Playing);\r\n        await PropMgr.inst.genatorProp();\r\n        await PlayerMgr.inst.playerAddComponent();\r\n        await PlayerMgr.inst.genareatorAIPlayer();\r\n        TimerMgr.inst.startCountdown();\r\n    }\r\n}\r\n\r\nexport enum GameStatus {\r\n    /** 游戏未开始 */\r\n    None,\r\n    /** 游戏进行中 */\r\n    Playing,\r\n    /** 游戏结束 */\r\n    End,\r\n}"]}