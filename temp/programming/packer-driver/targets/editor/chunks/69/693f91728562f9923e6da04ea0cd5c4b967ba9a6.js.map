{"version":3,"sources":["file:///E:/CocosCreator/StormSunder_Github/StormSunder/assets/module_storm_sunder/Script/Component/PropComponent.ts"],"names":["_decorator","CCBoolean","CCFloat","Collider","Component","tween","Tween","Vec3","Effect2DUIMgr","ccclass","property","PropStatus","PropComponent","type","displayName","currentHp","status","LIFE","speed","tigger","start","hp","node","getComponent","on","onTriggerEnter","onTriggerExit","hurt","damage","DIE","hpPercent","Instance","showBlood","removeBlood","swallow","stopAllByTarget","by","position","y","call","removeFromParent","destroy","event","update","deltaTime","onDestroy"],"mappings":"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","sourcesContent":["import { _decorator, CCBoolean, CCFloat, Collider, Component, ITriggerEvent, Node, PhysicsSystem, tween, Tween, Vec3 } from 'cc';\r\nimport { Effect2DUIMgr } from '../Manager/Effect2DUIMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport enum PropStatus {\r\n    LIFE,\r\n    DIE\r\n}\r\n\r\n@ccclass('PropComponent')\r\nexport class PropComponent extends Component {\r\n\r\n    @property({ type: CCFloat })\r\n    hp: number = 1;\r\n\r\n    @property({ type: CCFloat })\r\n    currentExp: number = 10;\r\n\r\n    @property({ type: CCBoolean, displayName: \"是否可移动\" })\r\n    isMove: boolean = false;\r\n\r\n    currentHp: number = 0;\r\n    status: PropStatus = PropStatus.LIFE;\r\n    speed: number = 50;\r\n\r\n    tigger: Collider = null!;\r\n\r\n    start() {\r\n        this.status = PropStatus.LIFE;\r\n        this.currentHp = this.hp;\r\n\r\n        this.tigger = this.node.getComponent(Collider)!;\r\n        this.tigger.on('onTriggerEnter', this.onTriggerEnter, this);\r\n        this.tigger.on('onTriggerExit', this.onTriggerExit, this);\r\n    }\r\n\r\n    //受伤\r\n    async hurt(damage: number) {\r\n        if (this.status == PropStatus.DIE) return;\r\n\r\n        this.currentHp -= damage;\r\n        // console.log(`当前道具血量:${this.currentHp}`);\r\n\r\n        if (this.currentHp > 0) {\r\n            const hpPercent = this.currentHp / this.hp;\r\n            // 显示或更新血条\r\n            await Effect2DUIMgr.Instance.showBlood(this.node, hpPercent);\r\n        }\r\n\r\n        //小于0时死亡\r\n        if (this.currentHp <= 0) {\r\n            this.currentHp = 0;\r\n            this.status = PropStatus.DIE;\r\n            Effect2DUIMgr.Instance.removeBlood(this.node);\r\n        }\r\n    }\r\n\r\n    //卷入龙卷风\r\n    swallow() {\r\n        Tween.stopAllByTarget(this.node);\r\n        tween(this.node)\r\n            .by(1, { position: new Vec3(0, this.node.position.y + 5, 0) })\r\n            .call(() => {\r\n                this.node.removeFromParent();\r\n                this.node.destroy();\r\n            })\r\n            .start();\r\n    }\r\n\r\n    protected onTriggerEnter(event: ITriggerEvent): void {\r\n    }\r\n\r\n    onTriggerExit(event: ITriggerEvent): void {\r\n        Effect2DUIMgr.Instance.removeBlood(this.node);\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n\r\n    }\r\n\r\n    protected onDestroy(): void {\r\n\r\n    }\r\n}\r\n\r\n\r\n"]}