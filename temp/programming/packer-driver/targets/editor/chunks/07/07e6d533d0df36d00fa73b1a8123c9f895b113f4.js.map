{"version":3,"sources":["file:///E:/CocosCreator/StormSunder_Github/StormSunder/assets/core_tgx/base/ResLoader.ts"],"names":["ResLoader","Asset","assetManager","error","js","resources","warn","defaultBundleName","gameBundleName","cdn","bundles","Map","maxConcurrency","downloader","value","maxRequestsPerFrame","maxRetryCount","retryInterval","init","config","enable","bundleName","packages","set","loadRemote","url","args","options","onComplete","length","loadBundle","v","Promise","resolve","reject","version","err","bundle","removeBundle","get","releaseAll","preload","paths","type","onProgress","Array","parseLoadResArgs","loadByArgs","preloadAsync","data","message","preloadDir","dir","load","loadAsync","asset","loadDir","release","path","getBundle","releasePrefabtDepsRecursively","releaseDir","infos","getDirWithPath","map","info","uuid","decRef","assets","pathsOut","typeOut","onProgressOut","onCompleteOut","undefined","isValidType","isChildClassOf","loadByBundleAndArgs","dump","forEach","key","console","log","count","resLoader"],"mappings":"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","sourcesContent":["import { Asset, AssetManager, __private, assetManager, error, js, resources, warn } from \"cc\";\n\nexport type AssetType<T = Asset> = __private._types_globals__Constructor<T> | null;\nexport type Paths = string | string[];\nexport type ProgressCallback = ((finished: number, total: number, item: AssetManager.RequestItem) => void) | null;\nexport type CompleteCallback = any;\nexport type IRemoteOptions = { [k: string]: any; ext?: string; } | null;\n\ninterface ILoadResArgs<T extends Asset> {\n    /** 资源包名 */\n    bundle?: string;\n    /** 资源文件夹名 */\n    dir?: string;\n    /** 资源路径 */\n    paths: Paths;\n    /** 资源类型 */\n    type: AssetType<T>;\n    /** 资源加载进度 */\n    onProgress: ProgressCallback;\n    /** 资源加载完成 */\n    onComplete: CompleteCallback;\n    /** 是否为预加载 */\n    preload?: boolean;\n}\n\n/** \n * 游戏资源管理\n * 1、加载默认resources文件夹中资源\n * 2、加载默认bundle远程资源\n * 3、主动传递bundle名时，优先加载传递bundle名资源包中的资源\n * \n * @help    https://gitee.com/dgflash/oops-framework/wikis/pages?sort_id=12037901&doc_id=2873565\n */\nexport class ResLoader {\n    //#region 资源配置数据\n    /** 全局默认加载的资源包名 */\n    defaultBundleName: string = \"module_basic\";\n    gameBundleName: string = \"module_storm_sunder\";\n    /** 是否使用远程 CDN 资源 */\n    cdn: boolean = false;\n\n    /** 下载时的最大并发数 - 项目设置 -> 项目数据 -> 资源下载并发数，设置默认值；初始值为15 */\n    get maxConcurrency() {\n        return assetManager.downloader.maxConcurrency;\n    }\n    set maxConcurrency(value) {\n        assetManager.downloader.maxConcurrency = value;\n    }\n\n    /** 下载时每帧可以启动的最大请求数 - 默认值为15 */\n    get maxRequestsPerFrame() {\n        return assetManager.downloader.maxRequestsPerFrame;\n    }\n    set maxRequestsPerFrame(value) {\n        assetManager.downloader.maxRequestsPerFrame = value;\n    }\n\n    /** 失败重试次数 - 默认值为0 */\n    get maxRetryCount() {\n        return assetManager.downloader.maxRetryCount;\n    }\n    set maxRetryCount(value) {\n        assetManager.downloader.maxRetryCount = value;\n    }\n\n    /** 重试的间隔时间，单位为毫秒 - 默认值为2000毫秒 */\n    get retryInterval() {\n        return assetManager.downloader.retryInterval;\n    }\n    set retryInterval(value) {\n        assetManager.downloader.retryInterval = value;\n    }\n\n    /** 资源包配置 */\n    private bundles: Map<string, string> = new Map<string, string>();\n    //#endregion\n\n    init(config: any) {\n        this.cdn = config.enable;\n        for (let bundleName in config.packages) {\n            this.bundles.set(bundleName, config.packages[bundleName]);\n        }\n    }\n\n    //#region 加载远程资源\n    /**\n     * 加载远程资源\n     * @param url           资源地址\n     * @param options       资源参数，例：{ ext: \".png\" }\n     * @param onComplete    加载完成回调\n     * @example\nvar opt: IRemoteOptions = { ext: \".png\" };\nvar onComplete = (err: Error | null, data: ImageAsset) => {\n    const texture = new Texture2D();\n    texture.image = data;\n    \n    const spriteFrame = new SpriteFrame();\n    spriteFrame.texture = texture;\n    \n    var sprite = this.sprite.addComponent(Sprite);\n    sprite.spriteFrame = spriteFrame;\n}\noops.res.loadRemote<ImageAsset>(this.url, opt, onComplete);\n     */\n    loadRemote<T extends Asset>(url: string, options: IRemoteOptions | null, onComplete?: CompleteCallback): void;\n    loadRemote<T extends Asset>(url: string, onComplete?: CompleteCallback): void;\n    loadRemote<T extends Asset>(url: string, ...args: any): void {\n        let options: IRemoteOptions | null = null;\n        let onComplete: CompleteCallback = null;\n        if (args.length == 2) {\n            options = args[0];\n            onComplete = args[1];\n        }\n        else {\n            onComplete = args[0];\n        }\n        assetManager.loadRemote<T>(url, options, onComplete);\n    }\n    //#endregion\n\n    //#region 资源包管理\n    /**\n     * 加载资源包\n     * @param url       资源地址\n     * @param v         资源MD5版本号\n     * @example\nvar serverUrl = \"http://192.168.1.8:8080/\";         // 服务器地址\nvar md5 = \"8e5c0\";                                  // Cocos Creator 构建后的MD5字符\nawait oops.res.loadBundle(serverUrl,md5);\n     */\n    loadBundle(url: string, v?: string) {\n        return new Promise<AssetManager.Bundle>((resolve, reject) => {\n            assetManager.loadBundle(url, { version: v }, (err, bundle: AssetManager.Bundle) => {\n                if (err) {\n                    return error(err);\n                }\n                resolve(bundle);\n            });\n        });\n    }\n\n    /**\n     * 释放资源包与包中所有资源\n     * @param bundleName 资源地址\n     */\n    removeBundle(bundleName: string) {\n        let bundle = assetManager.bundles.get(bundleName);\n        if (bundle) {\n            bundle.releaseAll();\n            assetManager.removeBundle(bundle);\n        }\n    }\n    //#endregion\n\n    //#region 预加载资源\n    /**\n     * 加载一个资源\n     * @param bundleName    远程包名\n     * @param paths         资源路径\n     * @param type          资源类型\n     * @param onProgress    加载进度回调\n     * @param onComplete    加载完成回调\n     */\n    preload<T extends Asset>(bundleName: string, paths: Paths, type: AssetType<T>, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    preload<T extends Asset>(bundleName: string, paths: Paths, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    preload<T extends Asset>(bundleName: string, paths: Paths, onComplete?: CompleteCallback): void;\n    preload<T extends Asset>(bundleName: string, paths: Paths, type: AssetType<T>, onComplete?: CompleteCallback): void;\n    preload<T extends Asset>(paths: Paths, type: AssetType<T>, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    preload<T extends Asset>(paths: Paths, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    preload<T extends Asset>(paths: Paths, onComplete?: CompleteCallback): void;\n    preload<T extends Asset>(paths: Paths, type: AssetType<T>, onComplete?: CompleteCallback): void;\n    preload<T extends Asset>(\n        bundleName: string,\n        paths?: Paths | AssetType<T> | ProgressCallback | CompleteCallback,\n        type?: AssetType<T> | ProgressCallback | CompleteCallback,\n        onProgress?: ProgressCallback | CompleteCallback,\n        onComplete?: CompleteCallback,\n    ) {\n        let args: ILoadResArgs<Asset> | null = null;\n        if (typeof paths === \"string\" || paths instanceof Array) {\n            args = this.parseLoadResArgs(paths, type, onProgress, onComplete);\n            args.bundle = bundleName;\n        }\n        else {\n            args = this.parseLoadResArgs(bundleName, paths, type, onProgress);\n            args.bundle = this.defaultBundleName;\n        }\n        args.preload = true;\n        this.loadByArgs(args);\n    }\n\n    /**\n     * 异步加载一个资源\n     * @param bundleName    远程包名\n     * @param paths         资源路径\n     * @param type          资源类型\n     */\n    preloadAsync<T extends Asset>(bundleName: string, paths: Paths, type: AssetType<T>): Promise<AssetManager.RequestItem>;\n    preloadAsync<T extends Asset>(bundleName: string, paths: Paths): Promise<AssetManager.RequestItem>;\n    preloadAsync<T extends Asset>(paths: Paths, type: AssetType<T>): Promise<AssetManager.RequestItem>;\n    preloadAsync<T extends Asset>(paths: Paths): Promise<AssetManager.RequestItem>;\n    preloadAsync<T extends Asset>(bundleName: string,\n        paths?: Paths | AssetType<T> | ProgressCallback | CompleteCallback,\n        type?: AssetType<T> | ProgressCallback | CompleteCallback): Promise<AssetManager.RequestItem> {\n        return new Promise((resolve, reject) => {\n            this.preload(bundleName, paths, type, (err: Error | null, data: AssetManager.RequestItem) => {\n                if (err) {\n                    warn(err.message);\n                }\n                resolve(data);\n            });\n        });\n    }\n\n    /**\n     * 预加载文件夹中的资源\n     * @param bundleName    远程包名\n     * @param dir           文件夹名\n     * @param type          资源类型\n     * @param onProgress    加载进度回调\n     * @param onComplete    加载完成回调\n     */\n    preloadDir<T extends Asset>(bundleName: string, dir: string, type: AssetType<T>, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    preloadDir<T extends Asset>(bundleName: string, dir: string, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    preloadDir<T extends Asset>(bundleName: string, dir: string, onComplete?: CompleteCallback): void;\n    preloadDir<T extends Asset>(bundleName: string, dir: string, type: AssetType<T>, onComplete?: CompleteCallback): void;\n    preloadDir<T extends Asset>(dir: string, type: AssetType<T>, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    preloadDir<T extends Asset>(dir: string, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    preloadDir<T extends Asset>(dir: string, onComplete?: CompleteCallback): void;\n    preloadDir<T extends Asset>(dir: string, type: AssetType<T>, onComplete?: CompleteCallback): void;\n    preloadDir<T extends Asset>(\n        bundleName: string,\n        dir?: string | AssetType<T> | ProgressCallback | CompleteCallback,\n        type?: AssetType<T> | ProgressCallback | CompleteCallback,\n        onProgress?: ProgressCallback | CompleteCallback,\n        onComplete?: CompleteCallback,\n    ) {\n        let args: ILoadResArgs<T> | null = null;\n        if (typeof dir === \"string\") {\n            args = this.parseLoadResArgs(dir, type, onProgress, onComplete);\n            args.bundle = bundleName;\n        }\n        else {\n            args = this.parseLoadResArgs(bundleName, dir, type, onProgress);\n            args.bundle = this.defaultBundleName;\n        }\n        args.dir = args.paths as string;\n        args.preload = true;\n        this.loadByArgs(args);\n    }\n    //#endregion\n\n    //#region 资源加载、获取、释放\n    /**\n     * 加载一个资源\n     * @param bundleName    远程包名\n     * @param paths         资源路径\n     * @param type          资源类型\n     * @param onProgress    加载进度回调\n     * @param onComplete    加载完成回调\n     * @example\noops.res.load(\"spine_path\", sp.SkeletonData, (err: Error | null, sd: sp.SkeletonData) => {\n\n});\n     */\n    load<T extends Asset>(bundleName: string, paths: Paths, type: AssetType<T>, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    load<T extends Asset>(bundleName: string, paths: Paths, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    load<T extends Asset>(bundleName: string, paths: Paths, onComplete?: CompleteCallback): void;\n    load<T extends Asset>(bundleName: string, paths: Paths, type: AssetType<T>, onComplete?: CompleteCallback): void;\n    load<T extends Asset>(paths: Paths, type: AssetType<T>, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    load<T extends Asset>(paths: Paths, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    load<T extends Asset>(paths: Paths, onComplete?: CompleteCallback): void;\n    load<T extends Asset>(paths: Paths, type: AssetType<T>, onComplete?: CompleteCallback): void;\n    load<T extends Asset>(\n        bundleName: string,\n        paths?: Paths | AssetType<T> | ProgressCallback | CompleteCallback,\n        type?: AssetType<T> | ProgressCallback | CompleteCallback,\n        onProgress?: ProgressCallback | CompleteCallback,\n        onComplete?: CompleteCallback,\n    ) {\n        let args: ILoadResArgs<T> | null = null;\n        if (typeof paths === \"string\" || paths instanceof Array) {\n            args = this.parseLoadResArgs(paths, type, onProgress, onComplete);\n            args.bundle = bundleName;\n        }\n        else {\n            args = this.parseLoadResArgs(bundleName, paths, type, onProgress);\n            args.bundle = this.defaultBundleName;\n        }\n        this.loadByArgs(args);\n    }\n\n    /**\n     * 异步加载一个资源\n     * @param bundleName    远程包名\n     * @param paths         资源路径\n     * @param type          资源类型\n     */\n    loadAsync<T extends Asset>(bundleName: string, paths: Paths, type: AssetType<T>): Promise<T>;\n    loadAsync<T extends Asset>(bundleName: string, paths: Paths): Promise<T>;\n    loadAsync<T extends Asset>(paths: Paths, type: AssetType<T>): Promise<T>;\n    loadAsync<T extends Asset>(paths: Paths): Promise<T>;\n    loadAsync<T extends Asset>(bundleName: string,\n        paths?: Paths | AssetType<T> | ProgressCallback | CompleteCallback,\n        type?: AssetType<T> | ProgressCallback | CompleteCallback): Promise<T> {\n        return new Promise((resolve, reject) => {\n            this.load(bundleName, paths, type, (err: Error | null, asset: T) => {\n                if (err) {\n                    warn(err.message);\n                }\n                resolve(asset);\n            });\n        });\n    }\n\n    /**\n     * 加载文件夹中的资源\n     * @param bundleName    远程包名\n     * @param dir           文件夹名\n     * @param type          资源类型\n     * @param onProgress    加载进度回调\n     * @param onComplete    加载完成回调\n     * @example\n// 加载进度事件\nvar onProgressCallback = (finished: number, total: number, item: any) => {\n    console.log(\"资源加载进度\", finished, total);\n}\n\n// 加载完成事件\nvar onCompleteCallback = () => {\n    console.log(\"资源加载完成\");\n}\noops.res.loadDir(\"game\", onProgressCallback, onCompleteCallback);\n     */\n    loadDir<T extends Asset>(bundleName: string, dir: string, type: AssetType<T>, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    loadDir<T extends Asset>(bundleName: string, dir: string, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    loadDir<T extends Asset>(bundleName: string, dir: string, onComplete?: CompleteCallback): void;\n    loadDir<T extends Asset>(bundleName: string, dir: string, type: AssetType<T>, onComplete?: CompleteCallback): void;\n    loadDir<T extends Asset>(dir: string, type: AssetType<T>, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    loadDir<T extends Asset>(dir: string, onProgress: ProgressCallback, onComplete: CompleteCallback): void;\n    loadDir<T extends Asset>(dir: string, onComplete?: CompleteCallback): void;\n    loadDir<T extends Asset>(dir: string, type: AssetType<T>, onComplete?: CompleteCallback): void;\n    loadDir<T extends Asset>(\n        bundleName: string,\n        dir?: string | AssetType<T> | ProgressCallback | CompleteCallback,\n        type?: AssetType<T> | ProgressCallback | CompleteCallback,\n        onProgress?: ProgressCallback | CompleteCallback,\n        onComplete?: CompleteCallback,\n    ) {\n        let args: ILoadResArgs<T> | null = null;\n        if (typeof dir === \"string\") {\n            args = this.parseLoadResArgs(dir, type, onProgress, onComplete);\n            args.bundle = bundleName;\n        }\n        else {\n            args = this.parseLoadResArgs(bundleName, dir, type, onProgress);\n            args.bundle = this.defaultBundleName;\n        }\n        args.dir = args.paths as string;\n        this.loadByArgs(args);\n    }\n\n    /**\n     * 通过资源相对路径释放资源\n     * @param path          资源路径\n     * @param bundleName    远程资源包名\n     */\n    release(path: string, bundleName: string = this.defaultBundleName) {\n        const bundle = assetManager.getBundle(bundleName);\n        if (bundle) {\n            const asset = bundle.get(path);\n            if (asset) {\n                this.releasePrefabtDepsRecursively(asset);\n            }\n        }\n    }\n\n    /**\n     * 通过相对文件夹路径删除所有文件夹中资源\n     * @param path          资源文件夹路径\n     * @param bundleName    远程资源包名\n     */\n    releaseDir(path: string, bundleName: string = this.defaultBundleName) {\n        const bundle: AssetManager.Bundle | null = assetManager.getBundle(bundleName);\n        if (bundle) {\n            var infos = bundle.getDirWithPath(path);\n            if (infos) {\n                infos.map((info) => {\n                    this.releasePrefabtDepsRecursively(info.uuid);\n                });\n            }\n\n            if (path == \"\" && bundleName != \"resources\") {\n                assetManager.removeBundle(bundle);\n            }\n        }\n    }\n\n    /** 释放预制依赖资源 */\n    private releasePrefabtDepsRecursively(uuid: string | Asset) {\n        if (uuid instanceof Asset) {\n            uuid.decRef();\n            // assetManager.releaseAsset(uuid);\n        }\n        else {\n            const asset = assetManager.assets.get(uuid);\n            if (asset) {\n                asset.decRef();\n                // assetManager.releaseAsset(asset);\n            }\n        }\n    }\n\n    /**\n     * 获取资源\n     * @param path          资源路径\n     * @param type          资源类型\n     * @param bundleName    远程资源包名\n     */\n    get<T extends Asset>(path: string, type?: AssetType<T>, bundleName: string = this.defaultBundleName): T | null {\n        var bundle: AssetManager.Bundle = assetManager.getBundle(bundleName)!;\n        return bundle.get(path, type);\n    }\n    //#endregion\n\n    private parseLoadResArgs<T extends Asset>(\n        paths: Paths,\n        type?: AssetType<T> | ProgressCallback | CompleteCallback,\n        onProgress?: AssetType<T> | ProgressCallback | CompleteCallback,\n        onComplete?: ProgressCallback | CompleteCallback\n    ) {\n        let pathsOut: any = paths;\n        let typeOut: any = type;\n        let onProgressOut: any = onProgress;\n        let onCompleteOut: any = onComplete;\n        if (onComplete === undefined) {\n            const isValidType = js.isChildClassOf(type as AssetType, Asset);\n            if (onProgress) {\n                onCompleteOut = onProgress as CompleteCallback;\n                if (isValidType) {\n                    onProgressOut = null;\n                }\n            }\n            else if (onProgress === undefined && !isValidType) {\n                onCompleteOut = type as CompleteCallback;\n                onProgressOut = null;\n                typeOut = null;\n            }\n            if (onProgress !== undefined && !isValidType) {\n                onProgressOut = type as ProgressCallback;\n                typeOut = null;\n            }\n        }\n        return { paths: pathsOut, type: typeOut, onProgress: onProgressOut, onComplete: onCompleteOut };\n    }\n\n    private loadByBundleAndArgs<T extends Asset>(bundle: AssetManager.Bundle, args: ILoadResArgs<T>): void {\n        if (args.dir) {\n            if (args.preload) {\n                bundle.preloadDir(args.paths as string, args.type, args.onProgress, args.onComplete);\n            }\n            else {\n                bundle.loadDir(args.paths as string, args.type, args.onProgress, args.onComplete);\n            }\n        }\n        else {\n            if (args.preload) {\n                bundle.preload(args.paths as any, args.type, args.onProgress, args.onComplete);\n            }\n            else {\n                bundle.load(args.paths as any, args.type, args.onProgress, args.onComplete);\n            }\n        }\n    }\n\n    private async loadByArgs<T extends Asset>(args: ILoadResArgs<T>) {\n        if (args.bundle) {\n            let bundle = assetManager.bundles.get(args.bundle);\n            // 获取缓存中的资源包\n            if (bundle) {\n                this.loadByBundleAndArgs(bundle, args);\n            }\n            // 自动加载资源包\n            else {\n                const v = this.cdn ? this.bundles.get(args.bundle) : \"\";\n                bundle = await this.loadBundle(args.bundle, v);\n                if (bundle) this.loadByBundleAndArgs(bundle, args);\n            }\n        }\n        // 默认资源包\n        else {\n            this.loadByBundleAndArgs(resources, args);\n        }\n    }\n\n    /** 打印缓存中所有资源信息 */\n    dump() {\n        assetManager.assets.forEach((value: Asset, key: string) => {\n            console.log(assetManager.assets.get(key));\n        })\n        console.log(`当前资源总数:${assetManager.assets.count}`);\n    }\n}\n\nexport const resLoader = new ResLoader();"]}