{"version":3,"sources":["file:///E:/CocosCreator/StormSunder_Github/StormSunder/assets/core_tgx/base/ad/AdvertMgr.ts"],"names":["_decorator","EventDispatcher","ADEvent","AudioMgr","tgxUITips","GtagMgr","GtagType","ccclass","property","AdvertMgr","adInstance","gtag","instance","_instance","initilize","window","console","log","showInterstitial","cb","interstitialAd","beforeAd","afterAd","error","err","show","showReawardVideo","rewardAd","emit","REWARD_VIDEO_PLAY","inst","pause","adDismissed","REWARD_VIDEO_DISMISSED","resume","adViewed","REWARD_VIDEO_CLOSEED","REWARD_VIDEO_ERROR","doGameDot","ad_error"],"mappings":"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","sourcesContent":["import { _decorator, Node, Prefab, instantiate, Component, Camera, UITransform, v3, game, view, screen, tween, Vec3 } from 'cc';\nimport { EventDispatcher } from '../../easy_ui_framework/EventDispatcher';\nimport { ADEvent } from './ADEvent';\nimport { AudioMgr } from '../AudioMgr';\nimport { tgxUITips } from 'db://assets/core_tgx/tgx';\nimport { GtagMgr, GtagType } from 'db://assets/core_tgx/base/GtagMgr';\nconst { ccclass, property } = _decorator;\n\n/** 广告管理*/\n@ccclass('AdvertMgr')\nexport class AdvertMgr {\n    private static _instance: AdvertMgr | null = null;\n    public static get instance(): AdvertMgr {\n        if (!this._instance) this._instance = new AdvertMgr();\n        return this._instance;\n    }\n\n    adInstance: any = null;\n    gtag: any = null;\n\n    initilize(): void {\n        this.adInstance = (window as any)['adInstance'];\n        console.log('ad sdk初始化');\n        console.log(this.adInstance);\n    }\n\n    /** 显示插屏广告*/\n    showInterstitial(cb?: () => void): void {\n        if (!this.adInstance) {\n            cb && cb();\n            return;\n        }\n\n        this.adInstance.interstitialAd({\n            beforeAd() {\n                console.log('The ad starts playing');\n            },\n            afterAd() {\n                console.log('The ad ends playing');\n            },\n            error(err) {\n                // console.log('The ad failed to load');\n                tgxUITips.show(err)\n            }\n        });\n    }\n\n    /** 显示激励广告*/\n    showReawardVideo(cb?: () => void): void {\n        if (!this.adInstance) {\n            cb && cb();\n            return;\n        }\n\n        this.adInstance.rewardAd({\n            beforeAd() {\n                console.log('The ad starts playing, and the game should pause.');\n                EventDispatcher.instance.emit(ADEvent.REWARD_VIDEO_PLAY);\n                AudioMgr.inst.pause();\n            },\n            adDismissed() {\n                console.log('Player dismissed the ad before completion.');\n                EventDispatcher.instance.emit(ADEvent.REWARD_VIDEO_DISMISSED);\n                AudioMgr.inst.resume();\n            },\n            adViewed() {\n                console.log('Ad was viewed and closed.');\n                if (cb) cb();\n                EventDispatcher.instance.emit(ADEvent.REWARD_VIDEO_CLOSEED);\n                AudioMgr.inst.resume();\n            },\n            error(err: any) {\n                // console.log(`激励广告错误:${err}`);\n                tgxUITips.show(err);\n                EventDispatcher.instance.emit(ADEvent.REWARD_VIDEO_ERROR);\n                AudioMgr.inst.resume();\n                GtagMgr.inst.doGameDot(GtagType.ad_error);\n            }\n        });\n    }\n}\n"]}